<template name="statsDeviation">
  <div class="panel panel-default">
    <div class="panel-body">
      {{#autoForm schema=filterSchema id='filterStatsDeviation' type='method' meteormethod='filterStatsDeviation' resetOnSuccess=false doc=filter}}
        <fieldset>
          <div class="row">
            <div class="col-md-4">
              {{> afQuickField name='start'}}
            </div>
            <div class="col-md-4">
              {{> afQuickField name='end'}}
            </div>
            <div class="col-md-4">
              {{> afQuickField name='plantId'}}
            </div>
          </div>
          <div class="row">
            <div class="col-md-4">
              {{> afQuickField name='strengthId' firstOption=false}}
            </div>
            <div class="col-md-4">
              {{> afQuickField name='aggregateId'}}
            </div>
            <div class="col-md-4">
              {{> afQuickField name='settlementId'}}
            </div>
          </div>

          <div class="row">
            <div class="col-md-4">
              {{> afQuickField name='tenPercentCriteria'}}
            </div>
            <div class="col-md-offset-4 col-md-4">
              <button type="submit" class="btn btn-default btn-block">
                {{_ 'graphic_filter_apply'}}
              </button>
            </div>
          </div>
        </fieldset>
      {{/autoForm}}
    </div>
  </div>

  <div class="panel panel-default">
    <div class="panel-heading">
      <h3 class="panel-title">{{_ 'deviation'}} / {{strength.name}}</h3>
    </div>
    <div class="panel-body">
      <p>
        {{_ 'deviation_stresses_count'}} (n): <strong>{{stresses.length}}</strong>
      </p>

      {{#if enoughStresses}}
        <p>
          {{_ 'deviation_mean_resistance'}} (f'cm): <strong>{{r meanResistance 1}}</strong>
        </p>

        <p>
          {{_ 'deviation_standard_deviation'}} (s): <strong>{{r standardDeviation 1}}</strong>
        </p>

        <p>
          {{_ 'deviation_resistance'}} (f'c): <strong>{{r resistance 1}}</strong>
        </p>

        <p>
          {{_ 'deviation_coefficient'}} (Î´): <strong>{{r coefficient 1}}</strong>
        </p>

        <table class="table table-hover table-condensed">
          <thead>
            <tr>
              <th>{{_ 'sample'}}</th>
              <th>{{_ 'crack_cracked_in'}}</th>
              <th>{{_ 'crack_stress'}}</th>
            </tr>
          </thead>
          <tbody>
            {{#each stresses}}
              <tr>
                <td>{{sample.name}}</td>
                <td>{{l crack.crackedIn 'L'}}</td>
                <td>{{r stress 1}} MPa</td>
              </tr>
            {{/each}}
          </tbody>
        </table>
      {{else}}
        <div class="alert alert-warning">
          {{_ 'deviation_not_enough_stresses'}}
        </div>
      {{/if}}
    </div>
  </div>
</template>
